<!DOCTYPE html>
<html>
  <head>
    <title>Receiver</title>
    <link href="/static/style.css" rel="stylesheet">
  </head>
  <body>
    <div class="top-row">
      <h2 id="message"></h2>
      <img id="image">
      <h2> Which shape corresponds to that word? </h2>
    </div>
    <div class="bottom-row">
      <button onclick="sendButtonId(1)"><img src="static/shapes/C.png" alt="Button 1"></button>
      <button onclick="sendButtonId(2)"><img src="static/shapes/S.png" alt="Button 2"></button>
      <button onclick="sendButtonId(3)"><img src="static/shapes/T.png" alt="Button 3"></button>
    </div>
    <p id="reminder" style="font-size: small; font-style: italic;"></p>
    <script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.min.js"></script>
    <script src="//code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" charset="utf-8">
        // Connect to the Socket.io server
        const socket = io();

        window.history.forward();
        function disableBack() {
          window.history.forward();
        }
        setTimeout("disableBack()", 0);
        window.onunload = function () {
          null;
        };

        // If connected, send the 'joined' event
        socket.on('connect', function() {
          socket.emit('joinedReceiver');
        });

        // Send the ID of the pressed button to the server
        function sendButtonId(id) {
          socket.emit('buttonPressedReceiver', id);
        }

        // if receive 'redirect' reidrect to the url
        socket.on('redirect', function(data) {
            window.location.href = data.url;
        });

        socket.on('contextWord', (data) => {
          const word = data.word;
          const imgSrc = data.img;
          const message = `You received the message <span style="color: #ff1493">${word}</span> and the shape is this position:`;
          document.getElementById('message').innerHTML = message;
          document.getElementById('image').src = imgSrc;
        });


        setTimeout(function() {
          const reminderText = "The red dot on the figure corresponds to the position of the shape that your partner encoded in the message.";
          $('#reminder').text(reminderText);
        }, 500);
    </script>
  </body>
</html>



